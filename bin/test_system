#!/bin/bash
# stop server if one is running
killall npm
killall node
echo "
_____ running grunt _____
"
grunt > /dev/null
echo "
_____ starting server _____
"
npm start &  > /dev/null
sudo Xvfb :10 -ac &  > /dev/null
export DISPLAY=:10  > /dev/null
# give our server some time to startup
sleep 10
echo "
_____ starting system tests _____
"
./node_modules/protractor/bin/protractor localprotractor.config.js
echo "
_____ system testing finished _____
"
# stop the server
killall npm
killall node